<% content_for :styles do %>
table.report {
  border-collapse: collapse;
}

table.report caption {
  font-weight: bold;
  font-size: 2em;
  border-top: 1px solid black;
  border-bottom: 1px solid black;
}

table.report thead {
  border-bottom: 1px solid black;
}

table.report tfoot {
  border-top: 1px solid black;
}

table.report tfoot td {
  font-weight: bold;
}

table.report tbody tr:nth-child(odd) {
  background-color: #EFEFFF;
}

table.report th, table.report td {
  padding-left: 4px;
  padding-right: 4px;
}

table.report th {
  text-align: left;
}

table.report td {
  font-family: monospace;
  text-align: right;
}
<% end %>

<table class="report">
  <caption>Lead Summary by Status and Agent</caption>
  <thead>
    <tr>
      <th></th>
      <% Setting.lead_status.each do |s| %>
        <th><%= s %></th>
      <% end %>
    </tr>
  </thead>
  <tfoot>
    <%= render :partial => "summary_by_status_and_agent_row", :locals => { :row => @report_rows[-1] } %>
  </tfoot>
  <tbody>
    <% @report_rows[0..-2].each do |row| %>
      <%= render :partial => "summary_by_status_and_agent_row", :locals => { :row => row } %>
    <% end %>
  </tbody>
</table>
